package transactions

import "database/sql"

/* Internally used result struct, implementing sql.Result:

// A Result summarizes an executed SQL command.
type Result interface {
	// LastInsertId returns the integer generated by the database
	// in response to a command. Typically this will be from an
	// "auto increment" column when inserting a new row. Not all
	// databases support this feature, and the syntax of such
	// statements varies.
	LastInsertId() (int64, error)

	// RowsAffected returns the number of rows affected by an
	// update, insert, or delete. Not every database or database
	// driver may support this.
	RowsAffected() (int64, error)
}
*/

type sqlResult struct {
	rowsAffected    int64
	lastInsertId    int64
	errRowsAffected error
	errLastInsertId error
}

func emptySqlResult() sql.Result {
	return sqlResult{}
}

func copySqlResult(r sql.Result) sql.Result {
	rowsAffected, errRowsAffected := r.RowsAffected()
	lastInsertId, errLastInsertId := r.LastInsertId()
	return sqlResult{
		rowsAffected:    rowsAffected,
		lastInsertId:    lastInsertId,
		errRowsAffected: errRowsAffected,
		errLastInsertId: errLastInsertId,
	}
}

func (s sqlResult) RowsAffected() (int64, error) {
	return s.rowsAffected, s.errRowsAffected
}

func (s sqlResult) LastInsertId() (int64, error) {
	return s.lastInsertId, s.errLastInsertId
}
